
## üìù Step 3. ÏöîÍµ¨ÏÇ¨Ìï≠ Ï†ïÏùò Î∞è ÏãúÌÄÄÏä§ Îã§Ïù¥Ïñ¥Í∑∏Îû®, ERD ÏÑ§Í≥Ñ
üëâüèª[ÏöîÍµ¨ÏÇ¨Ìï≠ Ï†ïÏùò](https://github.com/MinjiY/ecommerce-practice/blob/step03/specification.md#-ÏöîÍµ¨ÏÇ¨Ìï≠-Ï†ïÏùò)   
üëâüèª[Ïù¥Î≤§Ìä∏ Ïä§ÌÜ†Î∞ç](https://github.com/MinjiY/ecommerce-practice/blob/step03/specification.md#-Ïù¥Î≤§Ìä∏-Ïä§ÌÜ†Î∞ç)   
üëâüèª[ÏãúÌÄÄÏä§ Îã§Ïù¥Ïñ¥Í∑∏Îû®](https://github.com/MinjiY/ecommerce-practice/blob/step03/specification.md#-ÏãúÌÄÄÏä§Îã§Ïù¥Ïñ¥Í∑∏Îû®)   
üëâüèª[ERD ÏÑ§Í≥Ñ](https://github.com/MinjiY/ecommerce-practice/blob/step03/specification.md#-erd-ÏÑ§Í≥Ñ)   

## üíª Step 4. Mock API, Swagger-UI 
üëâüèª[Mock API](https://github.com/MinjiY/ecommerce-practice/blob/step04/specification.md#1-mock-api)   
üëâüèª[Swagger-UI](https://github.com/MinjiY/ecommerce-practice/blob/step04/specification.md#2-swagger-ui)

---
## üìñ ÏãúÎÇòÎ¶¨Ïò§
### Ï£ºÎ¨∏ ÏãúÎÇòÎ¶¨Ïò§
ÏÇ¨Ïö©ÏûêÎäî ÏÉÅÌíàÏùÑ ÏÑ†ÌÉùÌïòÏó¨ Ï£ºÎ¨∏ÏùÑ ÏúÑÌï¥ Ï£ºÎ¨∏ÏÑú ÏûëÏÑ±ÏúºÎ°ú ÎÑòÏñ¥Í∞ÑÎã§.
Ï£ºÎ¨∏ÏÑú ÏûëÏÑ±Ï§ëÏóê Ïø†Ìè∞ÏùÑ ÏÇ¨Ïö©ÌïòÍ≥† Ïã∂Îã§Î©¥ Î™®Îã¨ÏùÑ ÎùÑÏõå ÌòÑÏû¨ ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Ïø†Ìè∞ÏùÑ Ï°∞ÌöåÌïúÎã§, ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Ïø†Ìè∞ÏùÄ Ïó¨Îü¨Í∞úÏùº Ïàò ÏûàÎã§.
ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Ïø†Ìè∞ÏùÑ ÌôïÏù∏ÌïòÍ≥† Î¶¨Ïä§Ìä∏ Ï§ë ÏÇ¨Ïö©Ìï† Ïø†Ìè∞ÏùÑ ÏÑ†ÌÉùÌï¥ÏÑú ÌòÑÏû¨ Í≤∞Ï†ú Í∏àÏï°Ïóê Ìï†Ïù∏Îêú Í∏àÏï°ÏùÑ Ï†ÅÏö©ÌïúÎã§.
Í≤∞Ï†úÎ•º ÏúÑÌï¥ÏÑúÎäî Ï∂©Ï†ÑÎêú Í∏àÏï°Ïù¥ ÏûàÏñ¥Ïïº ÌïòÎ©∞, Ï∂©Ï†ÑÎêú Í∏àÏï°Ïù¥ Î∂ÄÏ°±ÌïòÎ©¥ Í≤∞Ï†úÎ•º Ìï† Ïàò ÏóÜÎã§.
Í≤∞Ï†ú Í∏àÏï°Ïù¥ Ï∂©Ï†ÑÎêú Í∏àÏï°Î≥¥Îã§ ÌÅ¨Î©¥ Í≤∞Ï†úÌï† Ïàò ÏóÜÎã§Îäî Î©îÏãúÏßÄÎ•º ÎùÑÏö¥Îã§.


## üìÑ ÏöîÍµ¨ÏÇ¨Ìï≠ Ï†ïÏùò
### Í∏∞Îä• ÏöîÍµ¨ÏÇ¨Ìï≠
- ÏÇ¨Ïö©ÏûêÎäî Í≤∞Ï†úÏóê ÏÇ¨Ïö©Îê† Í∏àÏï°ÏùÑ Ï∂©Ï†ÑÌïúÎã§.
- Í≥†Í∞ùÏù¥ ÏÉÅÌíàÏùÑ Ï£ºÎ¨∏ÌïúÎã§.
- Ï£ºÎ¨∏ÌïòÍ∏∞ ÏúÑÌï¥ Ï∂©Ï†ÑÎêú Í∏àÏï°ÏúºÎ°ú Í≤∞Ï†úÌïúÎã§.
- ÏÉÅÌíà Îã§Ï§ëÏÑ†ÌÉùÏúºÎ°ú Ï£ºÎ¨∏Ìï† Ïàò ÏûàÎã§.
- Ï£ºÎ¨∏(Í≤∞Ï†ú)Ïãú ÏûîÏï°ÏùÑ Ï∞®Í∞êÌïúÎã§.
- Ï£ºÎ¨∏Ïù¥ ÏôÑÎ£åÎêòÎ©¥ Ï£ºÎ¨∏ÏôÑÎ£å ÏÉÅÌÉúÎ°ú Ï†ÑÌôòÎêúÎã§.
- Ï£ºÎ¨∏Ïù¥ ÏôÑÎ£åÎêòÎ©¥ Ï£ºÎ¨∏Ìïú ÏÉÅÌíàÏùò Ïû¨Í≥†Í∞Ä Í∞êÏÜåÌïúÎã§.
- ÏÇ¨Ïö©ÏûêÎäî ÏûêÏã†Ïùò ÏûîÏï°ÏùÑ Ï°∞ÌöåÌïúÎã§.
- ÏÉÅÌíàÏùÑ Ï°∞ÌöåÌï† Ïàò ÏûàÎã§. (ID, Ïù¥Î¶Ñ, Í∞ÄÍ≤©, ÏûîÏó¨ÏàòÎüâ)
- ÏÇ¨Ïö©ÏûêÎäî ÏµúÍ∑º 3ÏùºÍ∞Ñ Í∞ÄÏû• ÎßéÏù¥ ÌåîÎ¶∞ ÏÉÅÏúÑ 5Í∞ú ÏÉÅÌíàÏùÑ Ï°∞ÌöåÌïúÎã§.
- ÏÇ¨Ïö©ÏûêÎäî ÏûêÏã†Ïùò Ï£ºÎ¨∏ ÏÉÅÌÉúÎ•º ÌôïÏù∏ÌïúÎã§.
- Ï£ºÎ¨∏ÏùÑ Ï∑®ÏÜåÌïòÎ©¥ Ï∑®ÏÜåÌïú Í∏àÏï°Ïù¥ Ï∂©Ï†Ñ ÏûîÏï°Ïóê ÎçîÌï¥ÏßÑÎã§.
- Ï£ºÎ¨∏ÏùÑ Ï∑®ÏÜåÌïòÎ©¥ Ïû¨Í≥†Í∞Ä Îã§Ïãú Ï¶ùÍ∞ÄÌïúÎã§.
- Ï£ºÎ¨∏ÏùÑ Ï∑®ÏÜåÌïòÎ©¥ Ïø†Ìè∞Ïù¥ Îã§Ïãú ÏÇ¨Ïö©Í∞ÄÎä• ÏÉÅÌÉúÍ∞Ä ÎêúÎã§.
- Ï£ºÎ¨∏ÏùÑ Ï∑®ÏÜåÌïòÎ©¥ Ï£ºÎ¨∏Ï∑®ÏÜå ÏÉÅÌÉúÎ°ú Ï†ÑÌôòÎêúÎã§.
- ÏÇ¨Ïö©ÏûêÎäî ÏÑ†Ï∞©ÏàúÏúºÎ°ú Ïø†Ìè∞ÏùÑ Î∞úÍ∏âÎ∞õÎäîÎã§.
- Ïø†Ìè∞ 100Î™ÖÏùò ÏÑ†Ï∞©ÏàúÏãú 101Î™ÖÎ∂ÄÌÑ∞ Ïø†Ìè∞ Î∞úÍ∏âÏùÄ Ïã§Ìå®Ìï¥ÏïºÌïúÎã§.
- Ïø†Ìè∞ ÏÇ¨Ïö©Ïãú Ï†ÑÏ≤¥ Ï£ºÎ¨∏Í∏àÏï°ÏùÑ Ìï†Ïù∏ Î∞õÎäîÎã§.
- Ïø†Ìè∞ÏùÄ ÎßåÎ£åÏãúÍ∞ÑÏóê ÎßåÎ£åÎêúÎã§.
- Ïø†Ìè∞ÏùÄ Ï£ºÎ¨∏Îãπ 1Í∞ú ÏÇ¨Ïö©ÌïúÎã§.
- Ï£ºÎ¨∏Ìï†Îïå Ïø†Ìè∞ ÏÇ¨Ïö©Ïãú, Ìï†Ïù∏ Î∞õÏùÄ Í∏àÏï°ÎßåÌÅº Ï∂©Ï†ÑÍ∏àÏï°ÏùÑ Ï∞®Í∞êÌïúÎã§.
- ÏÇ¨Ïö©ÏûêÎäî Î≥¥Ïú† Ïø†Ìè∞ÏùÑ Ï°∞ÌöåÌïúÎã§.

### ÎπÑÍ∏∞Îä• ÏöîÍµ¨ÏÇ¨Ìï≠
- Ìä∏ÎûúÏû≠ÏÖò
    - Ï£ºÎ¨∏ ÏÑ±Í≥µÏãú Ïû¨Í≥†Ï∞®Í∞êÏùÄ ÎπÑÎèôÍ∏∞Ï†ÅÏúºÎ°ú Î∞òÏòÅÌïúÎã§.
    - Ï£ºÎ¨∏ ÏÑ±Í≥µÏãú Ï£ºÎ¨∏ ÏôÑÎ£åÏÉÅÌÉúÍ∞Ä ÎêòÏñ¥Ïïº ÌïúÎã§.
    - Ï£ºÎ¨∏Ïù¥ Ïã§Ìå®ÌïòÎ©¥ Í∏àÏï°Ï∞®Í∞êÏù¥ Ïã§Ìå®Ìï¥ÏïºÌïúÎã§.
    - Í∏àÏï°Ïù¥ Î∂ÄÏ°±ÌïòÎ©¥ Ï£ºÎ¨∏Ìï† Ïàò ÏóÜÎã§.
    - Ï£ºÎ¨∏ Ï∑®ÏÜåÏãú Ï∂©Ï†Ñ ÏûîÏï° Ï¶ùÍ∞ÄÍ∞Ä Ïã§Ìå®ÌïòÎ©¥ Ï£ºÎ¨∏Ï∑®ÏÜåÎèÑ Ïã§Ìå®ÌïúÎã§.
    - Î™®Îì† Ìä∏ÎûúÏû≠ÏÖò Ïã§Ìå®Îäî Retry 3Ìöå ÏãúÎèÑÌï¥ÏïºÌïúÎã§.
- Ïû•Ïï†Í≤©Î¶¨
    - Ï∂©Ï†ÑÎêú Í∏àÏï°Ïù¥ Ï°∞ÌöåÎêòÏßÄÏïäÏúºÎ©¥ Ï£ºÎ¨∏Ìï† Ïàò ÏóÜÎã§.
    - Ï£ºÎ¨∏(Í≤∞Ï†ú)ÏãúÏä§ÌÖúÏù¥ Í≥ºÏ§ëÎêòÎ©¥ ÏÇ¨Ïö©ÏûêÎ•º Ïû†Ïãú Î∞õÏßÄÏïäÍ≥† Í≤∞Ï†úÎ•º Ïû†ÏãúÌõÑÏóê ÌïòÎèÑÎ°ù Ïú†ÎèÑÌïúÎã§. (Circuit breaker, fallback)
    - ÏµúÍ∑º 3ÏùºÍ∞Ñ Í∞ÄÏû• ÎßéÏù¥ ÌåîÎ¶∞ ÏÉÅÏúÑ 5Í∞ú ÏÉÅÌíàÏùÑ Ï°∞ÌöåÌï† Ïàò ÏóÜÎã§Î©¥ ÏÇ¨Ïö©ÏûêÍ∞Ä Í∞ÄÏû• ÎßéÏù¥ Íµ¨ÏûÖÌñàÎçò ÏÉÅÌíà Ïπ¥ÌÖåÍ≥†Î¶¨Ïóê Ìï¥ÎãπÌïòÎäî ÏÉÅÌíàÏùÑ ÎûúÎç§ÌïòÍ≤å Ï∂îÏ≤úÌïúÎã§.
- ÏÑ±Îä•
    - ÏãúÍ∞ÑÎãπ ÌèâÍ∑† Ïù¥Ïö©ÏûêÍ∞Ä 10ÎßåÎ™ÖÏù¥ÎùºÍ≥† Ìï†Îïå, Ï£ºÎ¨∏(Í≤∞Ï†ú)Îäî Ï¥àÎãπ 1000Î™ÖÍπåÏßÄ ÏöîÏ≤≠ Í∞ÄÎä•Ìï¥ÏïºÌïúÎã§.

---
## üìä Ïù¥Î≤§Ìä∏ Ïä§ÌÜ†Î∞ç
1. ÎèÑÎ©îÏù∏ Ïù¥Î≤§Ìä∏ ÎèÑÏ∂ú
![image/event.png](image/event.png)

2. Ïª§Îß®Îìú ÎèÑÏ∂ú (Ïù¥Î≤§Ìä∏Î•º Ìä∏Î¶¨Í±∞ÌïòÎäî ÌñâÎèô)
![image/event2.png](image/event2.png)

3. Ïï°ÌÑ∞ ÎèÑÏ∂ú
![image/event3.png](image/event3.png)

4. Ïô∏Î∂ÄÏÑúÎπÑÏä§ ÎèÑÏ∂ú
![image/event4.png](image/event4.png)

5. Ïñ¥Í∑∏Î¶¨Í≤åÏù¥ÌÑ∞ ÎèÑÏ∂ú (ÏÉÅÌÉúÍ∞Ä Î≥ÄÍ≤ΩÎêòÎäî Îç∞Ïù¥ÌÑ∞ Î¨∂Ïùå, Ïó∞Í¥ÄÎêòÎäî ÏóîÌã∞Ìã∞ÏôÄ Í∞í Í∞ùÏ≤¥Ïùò Î¨∂Ïùå)
![image/event5.png](image/event5.png)

6. Bounded Context Ï†ïÏùò
![image/event6.png](image/event6.png)

7. Ï†ïÏ±Ö ÎèÑÏ∂ú
![image/event7.png](image/event7.png)

8. Ìò∏Ï∂úÍ¥ÄÍ≥Ñ Î™ÖÌôïÌïòÍ≤å ÌïòÍ∏∞
![image/event8.png](image/event8.png)


## üìå ÏãúÌÄÄÏä§Îã§Ïù¥Ïñ¥Í∑∏Îû®

### 1. Í∏àÏï° Ï∂©Ï†Ñ
![image/charge.png](image/charge.png)

### 2. ÏÉÅÌíà Ï£ºÎ¨∏
![image/order.png](image/order.png)

### 3. Ïø†Ìè∞ Î∞úÍ∏â
![image/coupon.png](image/coupon.png)

### 4. Ïø†Ìè∞ ÎßåÎ£å
![image/expired_coupon.png](image/expired_coupon.png)


---
## üë©‚Äçüíª ERD ÏÑ§Í≥Ñ
[DDL ÌååÏùº](https://github.com/MinjiY/ecommerce-practice/blob/step03/ddl.sql)
![image/erd.png](image/erd.png)   
- ÌïòÎÇòÏùò Ïø†Ìè∞ÏùÑ Ïó¨Îü¨ ÏÇ¨Ïö©ÏûêÍ∞Ä Î∞úÍ∏âÎ∞õÏùÑ Ïàò ÏûàÎã§.
- ÌïúÎ™ÖÏùò ÏÇ¨Ïö©ÏûêÎäî Ïó¨Îü¨ Ïø†Ìè∞ÏùÑ Î∞úÍ∏âÎ∞õÏùÑ Ïàò ÏûàÎã§.   
=> `MAP_USER_COUPON` ÌÖåÏù¥Î∏îÏùÑ ÌÜµÌï¥ Îã§ÎåÄÎã§ Í¥ÄÍ≥ÑÎ•º ÌëúÌòÑÌïúÎã§.
- ÌïòÎÇòÏùò Ïø†Ìè∞ Ï†ïÏ±ÖÏùÑ Ïó¨Îü¨ Ïø†Ìè∞Ïù¥ Í∞ÄÏßà Ïàò ÏûàÎã§.   
=> ex) 1Ïõî 30% Ìï†Ïù∏ Ïø†Ìè∞, ÏÑ†Ï∞©Ïàú 30% Ìï†Ïù∏Ïø†Ìè∞


<details><summary> DDL </summary>

```sql
CREATE TABLE USERS
(
    USER_ID  BIGINT AUTO_INCREMENT PRIMARY KEY,
    ACCOUNTS VARCHAR(30) NOT NULL
);
CREATE TABLE COUPONS
(
    COUPON_ID        BIGINT AUTO_INCREMENT PRIMARY KEY,
    COUPON_POLICY_ID BIGINT      UNIQUE NOT NULL,
    COUPON_STATE     VARCHAR(20) NOT NULL,
    FOREIGN KEY (COUPON_POLICY_ID) REFERENCES COUPON_POLICIES(COUPON_POLICY_ID)
);
CREATE TABLE COUPON_POLICIES
(
    COUPON_POLICY_ID   BIGINT AUTO_INCREMENT PRIMARY KEY,
    EXPIRATION_DAYS    INT         NOT NULL,
    COUPON_ID          BIGINT      NOT NULL,
    COUPON_TYPE        VARCHAR(20) NOT NULL,
    ISSUABLE_QUANTITY  INT         NOT NULL,
    REMAINING_QUANTITY INT         NOT NULL,
    DISCOUNT_RATE      DECIMAL(5, 2),
    DISCOUNT_AMOUNT    INT
);
CREATE TABLE MAP_USER_COUPON
(
    USER_ID   BIGINT NOT NULL,
    COUPON_ID BIGINT NOT NULL,
    PRIMARY KEY (USER_ID, COUPON_ID),
    FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID),
    FOREIGN KEY (COUPON_ID) REFERENCES COUPONS (COUPON_ID)
);
CREATE TABLE ORDERS
(
    ORDER_ID        BIGINT AUTO_INCREMENT PRIMARY KEY,
    USER_ID         BIGINT      NOT NULL,
    ORDER_STATUS    VARCHAR(20) NOT NULL,
    TOTAL_AMOUNT    BIGINT      NOT NULL,
    DISCOUNT_AMOUNT BIGINT      NOT NULL,
    ORDERED_AT      TIMESTAMP   NOT NULL,
    UPDATED_AT      TIMESTAMP   NOT NULL
);
CREATE TABLE ORDER_ITEMS
(
    ORDER_ITEM_ID  BIGINT AUTO_INCREMENT PRIMARY KEY,
    ORDER_ID       BIGINT       NOT NULL,
    USER_ID        BIGINT       NOT NULL,
    PRODUCT_NAME   VARCHAR(255) NOT NULL,
    PRODUCT_AMOUNT BIGINT       NOT NULL,
    ORDER_QUANTITY INT          NOT NULL,
    PRODUCT_ID     BIGINT       NOT NULL,
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS (ORDER_ID)
);
CREATE TABLE PAYMENT_HISTORY
(
    PAYMENT_HISTORY_ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    ORDER_ID           BIGINT      NOT NULL,
    USER_ID            BIGINT      NOT NULL,
    AMOUNT             BIGINT      NOT NULL,
    DISCOUNT_AMOUNT    BIGINT      NOT NULL,
    COUPON_ID          BIGINT,
    PAYMENT_STATUS     VARCHAR(20) NOT NULL, -- SUCCESS, FAILED, CANCELED
    REQUESTED_AT       TIMESTAMP   NOT NULL,
    UPDATED_AT         TIMESTAMP   NOT NULL,
    FOREIGN KEY (ORDER_ID) REFERENCES ORDERS (ORDER_ID)
);
CREATE TABLE PRODUCTS
(
    PRODUCT_ID    BIGINT AUTO_INCREMENT PRIMARY KEY,
    NAME          VARCHAR(255) NOT NULL,
    DESCRIPTION   TEXT         NOT NULL,
    CATEGORY      VARCHAR(20)  NOT NULL, --
    PRICE         BIGINT       NOT NULL,
    REGISTERED_AT TIMESTAMP    NOT NULL,
    UPDATED_AT    TIMESTAMP    NOT NULL,
    QUANTITY      INT          NOT NULL,
    STATES        VARCHAR(20)  NOT NULL  -- AVAILABLE, SOLD_OUT
);
CREATE TABLE PAY_MONEY
(
    PAY_MONEY_ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    BALANCE      BIGINT NOT NULL,
    USER_ID      BIGINT NOT NULL
);
CREATE TABLE PAY_MONEY_HISTORY
(
    PAY_MONEY_HISTORY_ID BIGINT AUTO_INCREMENT PRIMARY KEY,
    USER_ID              BIGINT      NOT NULL,
    PAY_MONEY_ID         BIGINT      NOT NULL,
    AMOUNT               BIGINT      NOT NULL,
    TRANSACTION_TYPE     VARCHAR(20) NOT NULL, -- DEPOSIT, WITHDRAW
    REQUESTED_AT         TIMESTAMP   NOT NULL,
    UPDATED_AT           TIMESTAMP   NOT NULL,
    FOREIGN KEY (PAY_MONEY_ID) REFERENCES PAY_MONEY (PAY_MONEY_ID)
);
```

</details>
---

## üíé Mock API

### 1. Mock API
[Ïª§Î∞ãÎßÅÌÅ¨](https://github.com/MinjiY/ecommerce-practice/commit/9c8502869767454cac46e7d568dd08a9f02bf72b)
### 2. Swagger-UI
![image/swagger-ui.png](image/swagger-ui.png)








